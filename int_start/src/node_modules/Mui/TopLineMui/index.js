import React, { useState } from 'react'
import AppBar from '@material-ui/core/AppBar'
import Toolbar from '@material-ui/core/Toolbar'
import IconButton from '@material-ui/core/IconButton'
import MenuIcon from '@material-ui/icons/Menu'
import { withRouter } from 'react-router-dom'

import './styles'
import classesTopLine from './stylesTopLine'
import Drawer from './DrawerMui'
import useScrollTrigger from '@material-ui/core/useScrollTrigger'
import { Slide, CssBaseline, FormGroup, FormControlLabel, Switch } from '@material-ui/core'
import { Link } from 'react-router-dom'

const TopLine = props => {
  const classes = classesTopLine()
  const [openMenu, setOpenMenu] = useState(false)
  const [logIn, setLogIn] = useState(false)

  const toggleMenu = () => setOpenMenu(!openMenu)

  const toggleDrawer = () => setOpenMenu(false)

  const HideOnScroll = props => {
    const { children, window } = props
    const trigger = useScrollTrigger({ target: window ? window() : undefined })

    return (
      <Slide appear={false} direction='down' in={!trigger} >
        {children}
      </Slide>
    )
  }

  const handleChange = e => {
    if (!logIn) {
      props.history.push('/sign-in')
    
    } else {
      props.history.push('/')
    }

    setLogIn(e.target.checked)
  }

  return (
    <div className={classes.root}>
      <CssBaseline>
        <HideOnScroll {...props}>
          <AppBar /* position='static' */>
            <Toolbar className={classes.toolbar}>

              <IconButton
                edge='start'
                color='inherit'
                className={classes.menuButton}
                aria-label='menu'
                onClick={toggleMenu}
              >
                <MenuIcon />
              </IconButton>

              <FormGroup>
                <FormControlLabel
                  control={
                    <Switch
                      checked={logIn}
                      onChange={handleChange}
                      aria-label="login awitch"
                    />}
                  label={logIn ? 'Logout' : 'Login'}
                  // labelPlacement='start'
                  className={classes.formControl}
                />
              </FormGroup>

              <Link to='/sign-up' className='top-line__link'>Sing Up</Link>

              <Drawer toggleDrawer={toggleDrawer} open={openMenu} />

            </Toolbar>
          </AppBar>
        </HideOnScroll>
      </CssBaseline>
    </div>
  )
}

export default withRouter(TopLine)