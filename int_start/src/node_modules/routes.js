import React, { useEffect } from 'react';
import { Switch, Route, Redirect } from 'react-router-dom';
import { connect } from 'react-redux';

import Phones from 'internetShop/containers/Phones';
import Phone from 'internetShop/containers/Phone';
import Basket from 'internetShop/containers/Basket';

import TaskList from 'taskList/containers/TaskList';
// import SignUp from 'Mui/authMui/SignUp';
// import SignIn from 'Mui/authMui/SignIn';
// import Recovery from 'Mui/authMui/Recovery';
import SignIn from 'Mui-3/auth/SignIn';
import SignUp from 'Mui-3/auth/SignUp';
import Recovery from 'Mui-3/auth/Recovery';
import { autoLogin } from 'internetShop/actions';
import Logout from 'Mui-3/auth/Logout';

const Routes = ({ isAuthenticated, autoLogin }) => {
  useEffect(() => {
    autoLogin();
  });

  const routes = isAuthenticated
    ? (
      <Switch>
        <Route exact path='/' component={Phones} />
        <Route path='/phones/:id' component={Phone} />
        <Route path='/categories/:id' component={Phones} />
        <Route path='/basket' component={Basket} />
        <Route path='/logout' component={Logout} />

        <Route path='/task-list' component={TaskList} />

        <Redirect to='/' />
      </Switch>
    )
    : (
      <Switch>
        <Route exact path='/' component={Phones} />
        <Route path='/phones/:id' component={Phone} />
        <Route path='/categories/:id' component={Phones} />
        <Route path='/basket' component={Basket} />
        <Route path='/sign-up' component={SignUp} />
        <Route path='/sign-in' component={SignIn} />
        <Route path='/recovery' component={Recovery} />

        <Redirect to='/' />
      </Switch>
    )

  return routes;
}

const mapStateToProps = state => {
  return {
    isAuthenticated: !!state.internetShop.auth.token,
    autoLogin
  };
}

export default connect(mapStateToProps)(Routes)